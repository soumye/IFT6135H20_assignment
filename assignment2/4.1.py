import matplotlib.pyplot as plt
import numpy as np

rnn = [3.57011714413602e-07, 4.2047335568895505e-07, 5.170667805032281e-07, 6.835391559434356e-07, 9.628025736674317e-07, 1.319630996476917e-06, 1.9703873022081098e-06, 2.9910420380474534e-06, 4.084645297552925e-06, 5.6913750086096115e-06, 7.621314580319449e-06, 9.955498171621002e-06, 1.36811395350378e-05, 1.81924260687083e-05, 2.48478063440416e-05, 3.443853711360134e-05, 4.703695231000893e-05, 6.438595301005989e-05, 9.540030441712588e-05, 0.00013313922681845725, 0.00018490130605641752, 0.0002538261469453573, 0.0003585551748983562, 0.0005137242842465639, 0.0007417023298330605, 0.0011266482761129737, 0.0017323192441836, 0.00267120567150414, 0.00415504677221179, 0.006803606636822224, 0.011492948047816753, 0.020084530115127563, 0.036136507987976074, 0.0737658217549324, 0.11940040439367294]

gru = [0.04885847866535187, 0.05242917314171791, 0.054912369698286057, 0.05586373433470726, 0.056806232780218124, 0.05782138556241989, 0.058860763907432556, 0.059689395129680634, 0.0605345219373703, 0.061307381838560104, 0.062064483761787415, 0.06308343261480331, 0.06422574818134308, 0.06539783626794815, 0.0666070505976677, 0.06768818199634552, 0.06919330358505249, 0.07054050266742706, 0.0720602348446846, 0.07354606688022614, 0.07525297999382019, 0.07699791342020035, 0.07885351032018661, 0.0807996392250061, 0.08301442861557007, 0.08499202132225037, 0.08760255575180054, 0.09101619571447372, 0.09497766196727753, 0.09980377554893494, 0.10579356551170349, 0.11455308645963669, 0.12861919403076172, 0.15192560851573944, 0.18377739191055298]

rnn = np.array(rnn)
gru = np.array(gru)

rnn = rnn/max(rnn)
gru = gru/max(gru)

t = np.arange(0., 35, 1)

plt.plot(t, rnn, 'r--', t, gru, 'bs')
plt.xlabel('Time step (t)')
plt.ylabel('Norm of gradient for L_T')
plt.legend(['RNN', 'GRU'],fontsize='xx-large')
plt.tight_layout()
plt.title('4.1 Comparision of Gradients in RNN(vanishing) vs GRU')
plt.show()